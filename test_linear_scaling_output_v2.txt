/opt/homebrew/anaconda3/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.8.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/opt/homebrew/anaconda3/lib/python3.9/site-packages/pandas/core/arrays/masked.py:61: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.5' currently installed).
  from pandas.core import (
/Users/adityapu/Documents/GitHub/deepcausalmmm/test_linear_scaling_100epochs.py:60: FutureWarning: SeriesGroupBy.fillna is deprecated and will be removed in a future version. Use obj.ffill() or obj.bfill() for forward or backward filling instead. If you want to fill with a single value, use Series.fillna instead
  df_complete[col] = df_complete.groupby(region_col)[col].fillna(method='ffill').fillna(method='bfill')
/Users/adityapu/Documents/GitHub/deepcausalmmm/test_linear_scaling_100epochs.py:60: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df_complete[col] = df_complete.groupby(region_col)[col].fillna(method='ffill').fillna(method='bfill')
================================================================================
TESTING LINEAR SCALING IMPLEMENTATION (y/mean)
================================================================================
Running quick 100-epoch test to verify architecture changes

Loading data...
Data: 190 regions × 109 weeks
Media channels: 13
Control variables: 7
Visits range: 0 - 15,778,575
Visits mean: 743,088

Creating configuration (100 epochs for quick test)...
Epochs: 100

Processing data with UnifiedDataPipeline...
WARNING -    WARNING: Holdout weeks (8) is small relative to burn-in weeks (6)
WARNING -    Note: Burn-in is added as padding, all 8 actual weeks will be evaluated
INFO - 
 Unified Data Pipeline - Time Series Split (Ratio-Based):
INFO -     Training: 101 actual weeks (weeks 1-101) - 92.7%
INFO -     Holdout: 8 actual weeks (weeks 102-109) - 7.3%
INFO -     Burn-in Padding: 6 weeks will be added to BOTH train and holdout
INFO -     Model sees: Train 107 weeks, Holdout 14 weeks
INFO -     Evaluation: Remove 6 padding weeks, evaluate on ALL actual data
INFO -     Time series approach: Training on historical data, testing on most recent data
Train weeks: 101
Holdout weeks: 101
INFO - 
 Unified Data Pipeline - Processing Training Data:
INFO -     Adding seasonality features to training data...
INFO -     Seasonality now handled by model's data-driven seasonal decomposition (not as control variable)
INFO -    Training data processed:
INFO -    Shape: 190 regions × 107 weeks
INFO -    Media channels: 13
INFO -    Control variables: 7 (seasonality now handled by model baseline)
INFO -    Scaler fitted on training data only
INFO -    Added 6 weeks padding
INFO - 
 Unified Data Pipeline - Processing Holdout Data:
INFO -    Adding seasonality features to holdout data BEFORE scaling...
INFO -     Seasonality now handled by model's data-driven seasonal decomposition (not as control variable)
INFO -    Holdout data processed with IDENTICAL transformations:
INFO -    Shape: 190 regions × 14 weeks
INFO -    Media channels: 13
INFO -    Control variables: 7 (seasonality now handled by model baseline)
INFO -    Used SAME scaler as training (no data leakage)
INFO -    Added SAME 6 weeks padding
Processed shapes:
  X_media: torch.Size([190, 107, 13])
  X_control: torch.Size([190, 107, 7])
  y: torch.Size([190, 107])

Linear scaling active:
  y_mean_per_region shape: torch.Size([190, 1])
  y_mean_per_region range: [0, 13649089]
  y_mean_per_region mean: 839764

Creating model...
Model created with 320 hidden units

Training for 100 epochs...
================================================================================
INFO - Initialized baselines (Linear scaled - y/mean):
INFO -    Region baselines range: [1.000, 1.000]
INFO -    Global bias (Linear scale): 0.000 [LEARNABLE - constrained ≥ 0 via softplus]
INFO -    Expected prediction baseline: 1.000 (normalized) -> ~839764 visits
INFO -  Extracting seasonal components per region...
INFO -     Processing 190 regions × 101 weeks
INFO -     Seasonal components extracted:
INFO -       Range: [-3393321.750, 1957011.250]
INFO -       Mean: 523.267
INFO -       Shape: torch.Size([190, 101])
INFO -  Initialized seasonal components:
INFO -    Seasonal coefficient: 1.000 [LEARNABLE - constrained ≥ 0 via softplus]
INFO -    Components range: [0.000, 1.000] (Min-Max scaled per region)
INFO -    Components mean: 0.531
INFO -    Scaling: Min-Max per region (0-1 range) - preserves seasonal patterns
INFO - Initialized stable coefficients from data:
INFO -   Media coeff range (POSITIVE-ONLY): [0.7052, 0.8937]
INFO -   Control coeff range: [-0.9588, 0.5716]
INFO - 
Warm-start Training (50 epochs)...
Warm-start:   0%|          | 0/50 [00:00<?, ?it/s]Warm-start:   0%|          | 0/50 [00:00<?, ?it/s, Loss=9.6823]Warm-start:   2%|▏         | 1/50 [00:00<00:28,  1.73it/s, Loss=9.6823]Warm-start:   2%|▏         | 1/50 [00:01<00:28,  1.73it/s, Loss=9.6457]Warm-start:   4%|▍         | 2/50 [00:01<00:25,  1.92it/s, Loss=9.6457]Warm-start:   4%|▍         | 2/50 [00:01<00:25,  1.92it/s, Loss=9.6092]Warm-start:   6%|▌         | 3/50 [00:01<00:22,  2.05it/s, Loss=9.6092]Warm-start:   6%|▌         | 3/50 [00:01<00:22,  2.05it/s, Loss=9.5724]Warm-start:   8%|▊         | 4/50 [00:01<00:21,  2.13it/s, Loss=9.5724]Warm-start:   8%|▊         | 4/50 [00:02<00:21,  2.13it/s, Loss=9.5352]Warm-start:  10%|█         | 5/50 [00:02<00:20,  2.19it/s, Loss=9.5352]Warm-start:  10%|█         | 5/50 [00:02<00:20,  2.19it/s, Loss=9.4973]Warm-start:  12%|█▏        | 6/50 [00:02<00:19,  2.23it/s, Loss=9.4973]Warm-start:  12%|█▏        | 6/50 [00:03<00:19,  2.23it/s, Loss=9.4585]Warm-start:  14%|█▍        | 7/50 [00:03<00:19,  2.25it/s, Loss=9.4585]Warm-start:  14%|█▍        | 7/50 [00:03<00:19,  2.25it/s, Loss=9.4186]Warm-start:  16%|█▌        | 8/50 [00:03<00:18,  2.27it/s, Loss=9.4186]Warm-start:  16%|█▌        | 8/50 [00:04<00:18,  2.27it/s, Loss=9.3773]Warm-start:  18%|█▊        | 9/50 [00:04<00:18,  2.27it/s, Loss=9.3773]Warm-start:  18%|█▊        | 9/50 [00:04<00:18,  2.27it/s, Loss=9.3346]Warm-start:  20%|██        | 10/50 [00:04<00:17,  2.25it/s, Loss=9.3346]Warm-start:  20%|██        | 10/50 [00:05<00:17,  2.25it/s, Loss=9.2902]Warm-start:  22%|██▏       | 11/50 [00:05<00:17,  2.27it/s, Loss=9.2902]Warm-start:  22%|██▏       | 11/50 [00:05<00:17,  2.27it/s, Loss=9.2438]Warm-start:  24%|██▍       | 12/50 [00:05<00:16,  2.28it/s, Loss=9.2438]Warm-start:  24%|██▍       | 12/50 [00:05<00:16,  2.28it/s, Loss=9.1951]Warm-start:  26%|██▌       | 13/50 [00:05<00:17,  2.12it/s, Loss=9.1951]Warm-start:  26%|██▌       | 13/50 [00:06<00:17,  2.12it/s, Loss=9.1441]Warm-start:  28%|██▊       | 14/50 [00:06<00:19,  1.81it/s, Loss=9.1441]Warm-start:  28%|██▊       | 14/50 [00:07<00:19,  1.81it/s, Loss=9.0900]Warm-start:  30%|███       | 15/50 [00:07<00:18,  1.91it/s, Loss=9.0900]Warm-start:  30%|███       | 15/50 [00:07<00:18,  1.91it/s, Loss=9.0327]Warm-start:  32%|███▏      | 16/50 [00:07<00:16,  2.00it/s, Loss=9.0327]Warm-start:  32%|███▏      | 16/50 [00:08<00:16,  2.00it/s, Loss=8.9720]Warm-start:  34%|███▍      | 17/50 [00:08<00:15,  2.09it/s, Loss=8.9720]Warm-start:  34%|███▍      | 17/50 [00:08<00:15,  2.09it/s, Loss=8.9072]Warm-start:  36%|███▌      | 18/50 [00:08<00:14,  2.16it/s, Loss=8.9072]Warm-start:  36%|███▌      | 18/50 [00:08<00:14,  2.16it/s, Loss=8.8378]Warm-start:  38%|███▊      | 19/50 [00:08<00:14,  2.19it/s, Loss=8.8378]Warm-start:  38%|███▊      | 19/50 [00:09<00:14,  2.19it/s, Loss=8.7639]Warm-start:  40%|████      | 20/50 [00:09<00:13,  2.22it/s, Loss=8.7639]Warm-start:  40%|████      | 20/50 [00:09<00:13,  2.22it/s, Loss=8.6849]Warm-start:  42%|████▏     | 21/50 [00:09<00:12,  2.24it/s, Loss=8.6849]Warm-start:  42%|████▏     | 21/50 [00:10<00:12,  2.24it/s, Loss=8.6007]Warm-start:  44%|████▍     | 22/50 [00:10<00:12,  2.25it/s, Loss=8.6007]Warm-start:  44%|████▍     | 22/50 [00:10<00:12,  2.25it/s, Loss=8.5106]Warm-start:  46%|████▌     | 23/50 [00:10<00:12,  2.25it/s, Loss=8.5106]Warm-start:  46%|████▌     | 23/50 [00:11<00:12,  2.25it/s, Loss=8.4144]Warm-start:  48%|████▊     | 24/50 [00:11<00:11,  2.25it/s, Loss=8.4144]Warm-start:  48%|████▊     | 24/50 [00:11<00:11,  2.25it/s, Loss=8.3130]Warm-start:  50%|█████     | 25/50 [00:11<00:11,  2.25it/s, Loss=8.3130]Warm-start:  50%|█████     | 25/50 [00:12<00:11,  2.25it/s, Loss=8.2064]Warm-start:  52%|█████▏    | 26/50 [00:12<00:10,  2.24it/s, Loss=8.2064]Warm-start:  52%|█████▏    | 26/50 [00:12<00:10,  2.24it/s, Loss=8.0953]Warm-start:  54%|█████▍    | 27/50 [00:12<00:10,  2.26it/s, Loss=8.0953]Warm-start:  54%|█████▍    | 27/50 [00:12<00:10,  2.26it/s, Loss=7.9803]Warm-start:  56%|█████▌    | 28/50 [00:12<00:09,  2.26it/s, Loss=7.9803]Warm-start:  56%|█████▌    | 28/50 [00:13<00:09,  2.26it/s, Loss=7.8637]Warm-start:  58%|█████▊    | 29/50 [00:13<00:09,  2.25it/s, Loss=7.8637]Warm-start:  58%|█████▊    | 29/50 [00:13<00:09,  2.25it/s, Loss=7.7473]Warm-start:  60%|██████    | 30/50 [00:13<00:08,  2.24it/s, Loss=7.7473]Warm-start:  60%|██████    | 30/50 [00:14<00:08,  2.24it/s, Loss=7.6349]Warm-start:  62%|██████▏   | 31/50 [00:14<00:08,  2.24it/s, Loss=7.6349]Warm-start:  62%|██████▏   | 31/50 [00:14<00:08,  2.24it/s, Loss=7.5284]Warm-start:  64%|██████▍   | 32/50 [00:14<00:08,  2.25it/s, Loss=7.5284]Warm-start:  64%|██████▍   | 32/50 [00:15<00:08,  2.25it/s, Loss=7.4324]Warm-start:  66%|██████▌   | 33/50 [00:15<00:07,  2.27it/s, Loss=7.4324]Warm-start:  66%|██████▌   | 33/50 [00:15<00:07,  2.27it/s, Loss=7.3479]Warm-start:  68%|██████▊   | 34/50 [00:15<00:07,  2.27it/s, Loss=7.3479]Warm-start:  68%|██████▊   | 34/50 [00:15<00:07,  2.27it/s, Loss=7.2769]Warm-start:  70%|███████   | 35/50 [00:15<00:06,  2.28it/s, Loss=7.2769]Warm-start:  70%|███████   | 35/50 [00:16<00:06,  2.28it/s, Loss=7.2146]Warm-start:  72%|███████▏  | 36/50 [00:16<00:06,  2.29it/s, Loss=7.2146]Warm-start:  72%|███████▏  | 36/50 [00:16<00:06,  2.29it/s, Loss=7.1522]Warm-start:  74%|███████▍  | 37/50 [00:16<00:05,  2.27it/s, Loss=7.1522]Warm-start:  74%|███████▍  | 37/50 [00:17<00:05,  2.27it/s, Loss=7.0848]Warm-start:  76%|███████▌  | 38/50 [00:17<00:05,  2.27it/s, Loss=7.0848]Warm-start:  76%|███████▌  | 38/50 [00:18<00:05,  2.27it/s, Loss=7.0046]Warm-start:  78%|███████▊  | 39/50 [00:18<00:05,  1.95it/s, Loss=7.0046]Warm-start:  78%|███████▊  | 39/50 [00:18<00:05,  1.95it/s, Loss=6.9076]Warm-start:  80%|████████  | 40/50 [00:18<00:04,  2.04it/s, Loss=6.9076]Warm-start:  80%|████████  | 40/50 [00:19<00:04,  2.04it/s, Loss=6.7925]Warm-start:  82%|████████▏ | 41/50 [00:19<00:05,  1.80it/s, Loss=6.7925]Warm-start:  82%|████████▏ | 41/50 [00:19<00:05,  1.80it/s, Loss=6.6649]Warm-start:  84%|████████▍ | 42/50 [00:19<00:04,  1.92it/s, Loss=6.6649]Warm-start:  84%|████████▍ | 42/50 [00:20<00:04,  1.92it/s, Loss=6.5252]Warm-start:  86%|████████▌ | 43/50 [00:20<00:03,  2.02it/s, Loss=6.5252]Warm-start:  86%|████████▌ | 43/50 [00:20<00:03,  2.02it/s, Loss=6.3754]Warm-start:  88%|████████▊ | 44/50 [00:20<00:02,  2.07it/s, Loss=6.3754]Warm-start:  88%|████████▊ | 44/50 [00:20<00:02,  2.07it/s, Loss=6.2194]Warm-start:  90%|█████████ | 45/50 [00:20<00:02,  2.14it/s, Loss=6.2194]Warm-start:  90%|█████████ | 45/50 [00:21<00:02,  2.14it/s, Loss=6.0519]Warm-start:  92%|█████████▏| 46/50 [00:21<00:01,  2.16it/s, Loss=6.0519]Warm-start:  92%|█████████▏| 46/50 [00:21<00:01,  2.16it/s, Loss=5.8793]Warm-start:  94%|█████████▍| 47/50 [00:21<00:01,  2.19it/s, Loss=5.8793]Warm-start:  94%|█████████▍| 47/50 [00:22<00:01,  2.19it/s, Loss=5.6950]Warm-start:  96%|█████████▌| 48/50 [00:22<00:00,  2.24it/s, Loss=5.6950]Warm-start:  96%|█████████▌| 48/50 [00:22<00:00,  2.24it/s, Loss=5.4998]Warm-start:  98%|█████████▊| 49/50 [00:22<00:00,  2.18it/s, Loss=5.4998]Warm-start:  98%|█████████▊| 49/50 [00:23<00:00,  2.18it/s, Loss=5.2935]Warm-start: 100%|██████████| 50/50 [00:23<00:00,  2.09it/s, Loss=5.2935]                                                                        INFO - 
 Main Training (100 epochs)...
Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   0%|          | 0/100 [00:00<?, ?it/s, TrL=1.78, TrR=1.9280, TrR²=-30.221, Best=2.3032, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   1%|          | 1/100 [00:00<00:51,  1.93it/s, TrL=1.78, TrR=1.9280, TrR²=-30.221, Best=2.3032, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   1%|          | 1/100 [00:00<00:51,  1.93it/s, TrL=1.53, TrR=2.2175, TrR²=-40.303, Best=2.2175, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   2%|▏         | 2/100 [00:00<00:45,  2.13it/s, TrL=1.53, TrR=2.2175, TrR²=-40.303, Best=2.2175, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   2%|▏         | 2/100 [00:01<00:45,  2.13it/s, TrL=1.43, TrR=3.6555, TrR²=-111.235, Best=2.2175, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   3%|▎         | 3/100 [00:01<00:44,  2.20it/s, TrL=1.43, TrR=3.6555, TrR²=-111.235, Best=2.2175, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   3%|▎         | 3/100 [00:01<00:44,  2.20it/s, TrL=1.21, TrR=3.6167, TrR²=-108.863, Best=2.2175, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   4%|▍         | 4/100 [00:01<00:43,  2.23it/s, TrL=1.21, TrR=3.6167, TrR²=-108.863, Best=2.2175, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   4%|▍         | 4/100 [00:02<00:43,  2.23it/s, TrL=1.21, TrR=4.3759, TrR²=-159.834, Best=2.2175, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   5%|▌         | 5/100 [00:02<00:42,  2.25it/s, TrL=1.21, TrR=4.3759, TrR²=-159.834, Best=2.2175, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   5%|▌         | 5/100 [00:02<00:42,  2.25it/s, TrL=1.03, TrR=3.7525, TrR²=-117.269, Best=2.2175, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   6%|▌         | 6/100 [00:02<00:42,  2.23it/s, TrL=1.03, TrR=3.7525, TrR²=-117.269, Best=2.2175, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   6%|▌         | 6/100 [00:03<00:42,  2.23it/s, TrL=0.91, TrR=2.2533, TrR²=-41.644, Best=2.2175, HoL=1.4, HoR=2.3032, HoR²=-10.000] Training:   7%|▋         | 7/100 [00:03<00:41,  2.26it/s, TrL=0.91, TrR=2.2533, TrR²=-41.644, Best=2.2175, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   7%|▋         | 7/100 [00:03<00:41,  2.26it/s, TrL=0.94, TrR=2.2158, TrR²=-40.238, Best=2.2158, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   8%|▊         | 8/100 [00:03<00:40,  2.26it/s, TrL=0.94, TrR=2.2158, TrR²=-40.238, Best=2.2158, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   8%|▊         | 8/100 [00:04<00:40,  2.26it/s, TrL=0.88, TrR=1.8823, TrR²=-28.759, Best=1.8823, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   9%|▉         | 9/100 [00:04<00:40,  2.26it/s, TrL=0.88, TrR=1.8823, TrR²=-28.759, Best=1.8823, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:   9%|▉         | 9/100 [00:04<00:40,  2.26it/s, TrL=0.73, TrR=1.2734, TrR²=-12.620, Best=1.2734, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:  10%|█         | 10/100 [00:04<00:39,  2.26it/s, TrL=0.73, TrR=1.2734, TrR²=-12.620, Best=1.2734, HoL=1.4, HoR=2.3032, HoR²=-10.000]Training:  10%|█         | 10/100 [00:04<00:39,  2.26it/s, TrL=0.66, TrR=0.9322, TrR²=-6.299, Best=1.2734, HoL=0.7, HoR=1.4523, HoR²=-7.460]  Training:  11%|█         | 11/100 [00:04<00:40,  2.19it/s, TrL=0.66, TrR=0.9322, TrR²=-6.299, Best=1.2734, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  11%|█         | 11/100 [00:05<00:40,  2.19it/s, TrL=0.63, TrR=0.7943, TrR²=-4.299, Best=0.7943, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  12%|█▏        | 12/100 [00:05<00:39,  2.21it/s, TrL=0.63, TrR=0.7943, TrR²=-4.299, Best=0.7943, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  12%|█▏        | 12/100 [00:05<00:39,  2.21it/s, TrL=0.62, TrR=0.7232, TrR²=-3.393, Best=0.7232, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  13%|█▎        | 13/100 [00:05<00:39,  2.21it/s, TrL=0.62, TrR=0.7232, TrR²=-3.393, Best=0.7232, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  13%|█▎        | 13/100 [00:06<00:39,  2.21it/s, TrL=0.66, TrR=0.9016, TrR²=-5.827, Best=0.7232, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  14%|█▍        | 14/100 [00:06<00:38,  2.22it/s, TrL=0.66, TrR=0.9016, TrR²=-5.827, Best=0.7232, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  14%|█▍        | 14/100 [00:06<00:38,  2.22it/s, TrL=0.64, TrR=0.7678, TrR²=-3.952, Best=0.7232, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  15%|█▌        | 15/100 [00:06<00:38,  2.23it/s, TrL=0.64, TrR=0.7678, TrR²=-3.952, Best=0.7232, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  15%|█▌        | 15/100 [00:07<00:38,  2.23it/s, TrL=0.62, TrR=0.7065, TrR²=-3.192, Best=0.7065, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  16%|█▌        | 16/100 [00:07<00:37,  2.22it/s, TrL=0.62, TrR=0.7065, TrR²=-3.192, Best=0.7065, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  16%|█▌        | 16/100 [00:07<00:37,  2.22it/s, TrL=0.58, TrR=0.6435, TrR²=-2.478, Best=0.6435, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  17%|█▋        | 17/100 [00:07<00:37,  2.21it/s, TrL=0.58, TrR=0.6435, TrR²=-2.478, Best=0.6435, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  17%|█▋        | 17/100 [00:08<00:37,  2.21it/s, TrL=0.55, TrR=0.6439, TrR²=-2.483, Best=0.6435, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  18%|█▊        | 18/100 [00:08<00:36,  2.24it/s, TrL=0.55, TrR=0.6439, TrR²=-2.483, Best=0.6435, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  18%|█▊        | 18/100 [00:08<00:36,  2.24it/s, TrL=0.52, TrR=0.6195, TrR²=-2.224, Best=0.6195, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  19%|█▉        | 19/100 [00:08<00:36,  2.20it/s, TrL=0.52, TrR=0.6195, TrR²=-2.224, Best=0.6195, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  19%|█▉        | 19/100 [00:09<00:36,  2.20it/s, TrL=0.49, TrR=0.6036, TrR²=-2.060, Best=0.6036, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  20%|██        | 20/100 [00:09<00:36,  2.19it/s, TrL=0.49, TrR=0.6036, TrR²=-2.060, Best=0.6036, HoL=0.7, HoR=1.4523, HoR²=-7.460]Training:  20%|██        | 20/100 [00:09<00:36,  2.19it/s, TrL=0.47, TrR=0.5941, TrR²=-1.964, Best=0.6036, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  21%|██        | 21/100 [00:09<00:37,  2.12it/s, TrL=0.47, TrR=0.5941, TrR²=-1.964, Best=0.6036, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  21%|██        | 21/100 [00:10<00:37,  2.12it/s, TrL=0.46, TrR=0.5815, TrR²=-1.840, Best=0.5815, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  22%|██▏       | 22/100 [00:10<00:36,  2.12it/s, TrL=0.46, TrR=0.5815, TrR²=-1.840, Best=0.5815, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  22%|██▏       | 22/100 [00:10<00:36,  2.12it/s, TrL=0.44, TrR=0.5831, TrR²=-1.855, Best=0.5815, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  23%|██▎       | 23/100 [00:10<00:35,  2.15it/s, TrL=0.44, TrR=0.5831, TrR²=-1.855, Best=0.5815, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  23%|██▎       | 23/100 [00:10<00:35,  2.15it/s, TrL=0.41, TrR=0.5656, TrR²=-1.687, Best=0.5656, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  24%|██▍       | 24/100 [00:10<00:35,  2.16it/s, TrL=0.41, TrR=0.5656, TrR²=-1.687, Best=0.5656, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  24%|██▍       | 24/100 [00:11<00:35,  2.16it/s, TrL=0.39, TrR=0.5586, TrR²=-1.621, Best=0.5586, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  25%|██▌       | 25/100 [00:11<00:33,  2.21it/s, TrL=0.39, TrR=0.5586, TrR²=-1.621, Best=0.5586, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  25%|██▌       | 25/100 [00:11<00:33,  2.21it/s, TrL=0.37, TrR=0.5488, TrR²=-1.530, Best=0.5488, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  26%|██▌       | 26/100 [00:11<00:33,  2.21it/s, TrL=0.37, TrR=0.5488, TrR²=-1.530, Best=0.5488, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  26%|██▌       | 26/100 [00:12<00:33,  2.21it/s, TrL=0.36, TrR=0.5375, TrR²=-1.426, Best=0.5375, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  27%|██▋       | 27/100 [00:12<00:33,  2.21it/s, TrL=0.36, TrR=0.5375, TrR²=-1.426, Best=0.5375, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  27%|██▋       | 27/100 [00:12<00:33,  2.21it/s, TrL=0.35, TrR=0.5278, TrR²=-1.340, Best=0.5278, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  28%|██▊       | 28/100 [00:12<00:32,  2.24it/s, TrL=0.35, TrR=0.5278, TrR²=-1.340, Best=0.5278, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  28%|██▊       | 28/100 [00:13<00:32,  2.24it/s, TrL=0.33, TrR=0.5173, TrR²=-1.248, Best=0.5173, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  29%|██▉       | 29/100 [00:13<00:31,  2.23it/s, TrL=0.33, TrR=0.5173, TrR²=-1.248, Best=0.5173, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  29%|██▉       | 29/100 [00:13<00:31,  2.23it/s, TrL=0.32, TrR=0.5082, TrR²=-1.169, Best=0.5082, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  30%|███       | 30/100 [00:13<00:31,  2.25it/s, TrL=0.32, TrR=0.5082, TrR²=-1.169, Best=0.5082, HoL=0.5, HoR=1.2221, HoR²=-4.990]Training:  30%|███       | 30/100 [00:14<00:31,  2.25it/s, TrL=0.31, TrR=0.4986, TrR²=-1.088, Best=0.5082, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  31%|███       | 31/100 [00:14<00:31,  2.20it/s, TrL=0.31, TrR=0.4986, TrR²=-1.088, Best=0.5082, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  31%|███       | 31/100 [00:14<00:31,  2.20it/s, TrL=0.30, TrR=0.4900, TrR²=-1.017, Best=0.4900, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  32%|███▏      | 32/100 [00:14<00:30,  2.21it/s, TrL=0.30, TrR=0.4900, TrR²=-1.017, Best=0.4900, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  32%|███▏      | 32/100 [00:14<00:30,  2.21it/s, TrL=0.29, TrR=0.4822, TrR²=-0.953, Best=0.4822, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  33%|███▎      | 33/100 [00:14<00:30,  2.21it/s, TrL=0.29, TrR=0.4822, TrR²=-0.953, Best=0.4822, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  33%|███▎      | 33/100 [00:15<00:30,  2.21it/s, TrL=0.27, TrR=0.4753, TrR²=-0.897, Best=0.4753, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  34%|███▍      | 34/100 [00:15<00:29,  2.23it/s, TrL=0.27, TrR=0.4753, TrR²=-0.897, Best=0.4753, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  34%|███▍      | 34/100 [00:15<00:29,  2.23it/s, TrL=0.26, TrR=0.4677, TrR²=-0.838, Best=0.4677, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  35%|███▌      | 35/100 [00:15<00:29,  2.23it/s, TrL=0.26, TrR=0.4677, TrR²=-0.838, Best=0.4677, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  35%|███▌      | 35/100 [00:16<00:29,  2.23it/s, TrL=0.25, TrR=0.4596, TrR²=-0.774, Best=0.4596, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  36%|███▌      | 36/100 [00:16<00:28,  2.23it/s, TrL=0.25, TrR=0.4596, TrR²=-0.774, Best=0.4596, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  36%|███▌      | 36/100 [00:16<00:28,  2.23it/s, TrL=0.25, TrR=0.4516, TrR²=-0.713, Best=0.4516, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  37%|███▋      | 37/100 [00:16<00:28,  2.24it/s, TrL=0.25, TrR=0.4516, TrR²=-0.713, Best=0.4516, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  37%|███▋      | 37/100 [00:17<00:28,  2.24it/s, TrL=0.24, TrR=0.4444, TrR²=-0.659, Best=0.4444, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  38%|███▊      | 38/100 [00:17<00:27,  2.24it/s, TrL=0.24, TrR=0.4444, TrR²=-0.659, Best=0.4444, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  38%|███▊      | 38/100 [00:17<00:27,  2.24it/s, TrL=0.23, TrR=0.4377, TrR²=-0.609, Best=0.4377, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  39%|███▉      | 39/100 [00:17<00:27,  2.23it/s, TrL=0.23, TrR=0.4377, TrR²=-0.609, Best=0.4377, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  39%|███▉      | 39/100 [00:18<00:27,  2.23it/s, TrL=0.23, TrR=0.4318, TrR²=-0.566, Best=0.4318, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  40%|████      | 40/100 [00:18<00:26,  2.25it/s, TrL=0.23, TrR=0.4318, TrR²=-0.566, Best=0.4318, HoL=0.3, HoR=1.0536, HoR²=-3.453]Training:  40%|████      | 40/100 [00:18<00:26,  2.25it/s, TrL=0.22, TrR=0.4258, TrR²=-0.523, Best=0.4318, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  41%|████      | 41/100 [00:18<00:26,  2.19it/s, TrL=0.22, TrR=0.4258, TrR²=-0.523, Best=0.4318, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  41%|████      | 41/100 [00:18<00:26,  2.19it/s, TrL=0.21, TrR=0.4203, TrR²=-0.484, Best=0.4203, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  42%|████▏     | 42/100 [00:18<00:25,  2.24it/s, TrL=0.21, TrR=0.4203, TrR²=-0.484, Best=0.4203, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  42%|████▏     | 42/100 [00:19<00:25,  2.24it/s, TrL=0.21, TrR=0.4152, TrR²=-0.448, Best=0.4152, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  43%|████▎     | 43/100 [00:19<00:25,  2.24it/s, TrL=0.21, TrR=0.4152, TrR²=-0.448, Best=0.4152, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  43%|████▎     | 43/100 [00:19<00:25,  2.24it/s, TrL=0.20, TrR=0.4098, TrR²=-0.411, Best=0.4098, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  44%|████▍     | 44/100 [00:19<00:25,  2.24it/s, TrL=0.20, TrR=0.4098, TrR²=-0.411, Best=0.4098, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  44%|████▍     | 44/100 [00:20<00:25,  2.24it/s, TrL=0.20, TrR=0.4053, TrR²=-0.379, Best=0.4053, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  45%|████▌     | 45/100 [00:20<00:24,  2.24it/s, TrL=0.20, TrR=0.4053, TrR²=-0.379, Best=0.4053, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  45%|████▌     | 45/100 [00:20<00:24,  2.24it/s, TrL=0.20, TrR=0.4015, TrR²=-0.354, Best=0.4015, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  46%|████▌     | 46/100 [00:20<00:24,  2.24it/s, TrL=0.20, TrR=0.4015, TrR²=-0.354, Best=0.4015, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  46%|████▌     | 46/100 [00:21<00:24,  2.24it/s, TrL=0.19, TrR=0.3982, TrR²=-0.331, Best=0.3982, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  47%|████▋     | 47/100 [00:21<00:23,  2.24it/s, TrL=0.19, TrR=0.3982, TrR²=-0.331, Best=0.3982, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  47%|████▋     | 47/100 [00:21<00:23,  2.24it/s, TrL=0.18, TrR=0.3925, TrR²=-0.294, Best=0.3925, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  48%|████▊     | 48/100 [00:21<00:22,  2.27it/s, TrL=0.18, TrR=0.3925, TrR²=-0.294, Best=0.3925, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  48%|████▊     | 48/100 [00:22<00:22,  2.27it/s, TrL=0.18, TrR=0.3894, TrR²=-0.273, Best=0.3894, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  49%|████▉     | 49/100 [00:22<00:22,  2.28it/s, TrL=0.18, TrR=0.3894, TrR²=-0.273, Best=0.3894, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  49%|████▉     | 49/100 [00:22<00:22,  2.28it/s, TrL=0.18, TrR=0.3853, TrR²=-0.247, Best=0.3853, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  50%|█████     | 50/100 [00:22<00:22,  2.22it/s, TrL=0.18, TrR=0.3853, TrR²=-0.247, Best=0.3853, HoL=0.3, HoR=0.9187, HoR²=-2.386]Training:  50%|█████     | 50/100 [00:23<00:22,  2.22it/s, TrL=0.18, TrR=0.3892, TrR²=-0.272, Best=0.3853, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  51%|█████     | 51/100 [00:23<00:22,  2.18it/s, TrL=0.18, TrR=0.3892, TrR²=-0.272, Best=0.3853, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  51%|█████     | 51/100 [00:23<00:22,  2.18it/s, TrL=0.17, TrR=0.3828, TrR²=-0.231, Best=0.3828, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  52%|█████▏    | 52/100 [00:23<00:21,  2.19it/s, TrL=0.17, TrR=0.3828, TrR²=-0.231, Best=0.3828, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  52%|█████▏    | 52/100 [00:23<00:21,  2.19it/s, TrL=0.17, TrR=0.3771, TrR²=-0.194, Best=0.3771, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  53%|█████▎    | 53/100 [00:23<00:21,  2.22it/s, TrL=0.17, TrR=0.3771, TrR²=-0.194, Best=0.3771, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  53%|█████▎    | 53/100 [00:24<00:21,  2.22it/s, TrL=0.16, TrR=0.3755, TrR²=-0.184, Best=0.3755, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  54%|█████▍    | 54/100 [00:24<00:20,  2.22it/s, TrL=0.16, TrR=0.3755, TrR²=-0.184, Best=0.3755, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  54%|█████▍    | 54/100 [00:24<00:20,  2.22it/s, TrL=0.16, TrR=0.3706, TrR²=-0.153, Best=0.3706, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  55%|█████▌    | 55/100 [00:24<00:20,  2.20it/s, TrL=0.16, TrR=0.3706, TrR²=-0.153, Best=0.3706, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  55%|█████▌    | 55/100 [00:25<00:20,  2.20it/s, TrL=0.16, TrR=0.3668, TrR²=-0.130, Best=0.3668, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  56%|█████▌    | 56/100 [00:25<00:19,  2.21it/s, TrL=0.16, TrR=0.3668, TrR²=-0.130, Best=0.3668, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  56%|█████▌    | 56/100 [00:25<00:19,  2.21it/s, TrL=0.16, TrR=0.3643, TrR²=-0.115, Best=0.3643, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  57%|█████▋    | 57/100 [00:25<00:19,  2.20it/s, TrL=0.16, TrR=0.3643, TrR²=-0.115, Best=0.3643, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  57%|█████▋    | 57/100 [00:26<00:19,  2.20it/s, TrL=0.16, TrR=0.3606, TrR²=-0.092, Best=0.3606, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  58%|█████▊    | 58/100 [00:26<00:19,  2.19it/s, TrL=0.16, TrR=0.3606, TrR²=-0.092, Best=0.3606, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  58%|█████▊    | 58/100 [00:26<00:19,  2.19it/s, TrL=0.15, TrR=0.3589, TrR²=-0.082, Best=0.3589, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  59%|█████▉    | 59/100 [00:26<00:18,  2.21it/s, TrL=0.15, TrR=0.3589, TrR²=-0.082, Best=0.3589, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  59%|█████▉    | 59/100 [00:27<00:18,  2.21it/s, TrL=0.15, TrR=0.3564, TrR²=-0.067, Best=0.3564, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  60%|██████    | 60/100 [00:27<00:17,  2.22it/s, TrL=0.15, TrR=0.3564, TrR²=-0.067, Best=0.3564, HoL=0.2, HoR=0.8177, HoR²=-1.682]Training:  60%|██████    | 60/100 [00:27<00:17,  2.22it/s, TrL=0.15, TrR=0.3536, TrR²=-0.050, Best=0.3564, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  61%|██████    | 61/100 [00:27<00:17,  2.19it/s, TrL=0.15, TrR=0.3536, TrR²=-0.050, Best=0.3564, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  61%|██████    | 61/100 [00:27<00:17,  2.19it/s, TrL=0.15, TrR=0.3515, TrR²=-0.038, Best=0.3515, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  62%|██████▏   | 62/100 [00:27<00:17,  2.21it/s, TrL=0.15, TrR=0.3515, TrR²=-0.038, Best=0.3515, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  62%|██████▏   | 62/100 [00:28<00:17,  2.21it/s, TrL=0.14, TrR=0.3497, TrR²=-0.027, Best=0.3497, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  63%|██████▎   | 63/100 [00:28<00:16,  2.22it/s, TrL=0.14, TrR=0.3497, TrR²=-0.027, Best=0.3497, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  63%|██████▎   | 63/100 [00:28<00:16,  2.22it/s, TrL=0.14, TrR=0.3471, TrR²=-0.012, Best=0.3471, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  64%|██████▍   | 64/100 [00:28<00:16,  2.19it/s, TrL=0.14, TrR=0.3471, TrR²=-0.012, Best=0.3471, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  64%|██████▍   | 64/100 [00:29<00:16,  2.19it/s, TrL=0.14, TrR=0.3455, TrR²=-0.003, Best=0.3455, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  65%|██████▌   | 65/100 [00:29<00:15,  2.21it/s, TrL=0.14, TrR=0.3455, TrR²=-0.003, Best=0.3455, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  65%|██████▌   | 65/100 [00:29<00:15,  2.21it/s, TrL=0.14, TrR=0.3437, TrR²=0.008, Best=0.3437, HoL=0.2, HoR=0.7360, HoR²=-1.173] Training:  66%|██████▌   | 66/100 [00:29<00:15,  2.23it/s, TrL=0.14, TrR=0.3437, TrR²=0.008, Best=0.3437, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  66%|██████▌   | 66/100 [00:30<00:15,  2.23it/s, TrL=0.14, TrR=0.3416, TrR²=0.020, Best=0.3416, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  67%|██████▋   | 67/100 [00:30<00:14,  2.21it/s, TrL=0.14, TrR=0.3416, TrR²=0.020, Best=0.3416, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  67%|██████▋   | 67/100 [00:30<00:14,  2.21it/s, TrL=0.14, TrR=0.3398, TrR²=0.030, Best=0.3398, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  68%|██████▊   | 68/100 [00:30<00:14,  2.20it/s, TrL=0.14, TrR=0.3398, TrR²=0.030, Best=0.3398, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  68%|██████▊   | 68/100 [00:31<00:14,  2.20it/s, TrL=0.14, TrR=0.3382, TrR²=0.040, Best=0.3382, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  69%|██████▉   | 69/100 [00:31<00:14,  2.19it/s, TrL=0.14, TrR=0.3382, TrR²=0.040, Best=0.3382, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  69%|██████▉   | 69/100 [00:31<00:14,  2.19it/s, TrL=0.13, TrR=0.3365, TrR²=0.049, Best=0.3365, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  70%|███████   | 70/100 [00:31<00:13,  2.20it/s, TrL=0.13, TrR=0.3365, TrR²=0.049, Best=0.3365, HoL=0.2, HoR=0.7360, HoR²=-1.173]Training:  70%|███████   | 70/100 [00:32<00:13,  2.20it/s, TrL=0.13, TrR=0.3351, TrR²=0.057, Best=0.3365, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  71%|███████   | 71/100 [00:32<00:13,  2.16it/s, TrL=0.13, TrR=0.3351, TrR²=0.057, Best=0.3365, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  71%|███████   | 71/100 [00:32<00:13,  2.16it/s, TrL=0.13, TrR=0.3335, TrR²=0.066, Best=0.3335, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  72%|███████▏  | 72/100 [00:32<00:12,  2.17it/s, TrL=0.13, TrR=0.3335, TrR²=0.066, Best=0.3335, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  72%|███████▏  | 72/100 [00:33<00:12,  2.17it/s, TrL=0.13, TrR=0.3319, TrR²=0.075, Best=0.3319, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  73%|███████▎  | 73/100 [00:33<00:12,  2.18it/s, TrL=0.13, TrR=0.3319, TrR²=0.075, Best=0.3319, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  73%|███████▎  | 73/100 [00:33<00:12,  2.18it/s, TrL=0.13, TrR=0.3305, TrR²=0.083, Best=0.3305, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  74%|███████▍  | 74/100 [00:33<00:11,  2.19it/s, TrL=0.13, TrR=0.3305, TrR²=0.083, Best=0.3305, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  74%|███████▍  | 74/100 [00:33<00:11,  2.19it/s, TrL=0.13, TrR=0.3291, TrR²=0.090, Best=0.3291, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  75%|███████▌  | 75/100 [00:33<00:11,  2.21it/s, TrL=0.13, TrR=0.3291, TrR²=0.090, Best=0.3291, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  75%|███████▌  | 75/100 [00:34<00:11,  2.21it/s, TrL=0.13, TrR=0.3277, TrR²=0.098, Best=0.3277, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  76%|███████▌  | 76/100 [00:34<00:10,  2.22it/s, TrL=0.13, TrR=0.3277, TrR²=0.098, Best=0.3277, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  76%|███████▌  | 76/100 [00:34<00:10,  2.22it/s, TrL=0.13, TrR=0.3265, TrR²=0.105, Best=0.3265, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  77%|███████▋  | 77/100 [00:34<00:10,  2.21it/s, TrL=0.13, TrR=0.3265, TrR²=0.105, Best=0.3265, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  77%|███████▋  | 77/100 [00:35<00:10,  2.21it/s, TrL=0.13, TrR=0.3252, TrR²=0.111, Best=0.3252, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  78%|███████▊  | 78/100 [00:35<00:09,  2.22it/s, TrL=0.13, TrR=0.3252, TrR²=0.111, Best=0.3252, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  78%|███████▊  | 78/100 [00:35<00:09,  2.22it/s, TrL=0.13, TrR=0.3241, TrR²=0.118, Best=0.3241, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  79%|███████▉  | 79/100 [00:35<00:10,  2.00it/s, TrL=0.13, TrR=0.3241, TrR²=0.118, Best=0.3241, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  79%|███████▉  | 79/100 [00:36<00:10,  2.00it/s, TrL=0.13, TrR=0.3229, TrR²=0.124, Best=0.3229, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  80%|████████  | 80/100 [00:36<00:10,  1.96it/s, TrL=0.13, TrR=0.3229, TrR²=0.124, Best=0.3229, HoL=0.2, HoR=0.6776, HoR²=-0.842]Training:  80%|████████  | 80/100 [00:36<00:10,  1.96it/s, TrL=0.12, TrR=0.3218, TrR²=0.130, Best=0.3229, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  81%|████████  | 81/100 [00:36<00:09,  1.98it/s, TrL=0.12, TrR=0.3218, TrR²=0.130, Best=0.3229, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  81%|████████  | 81/100 [00:37<00:09,  1.98it/s, TrL=0.12, TrR=0.3207, TrR²=0.136, Best=0.3207, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  82%|████████▏ | 82/100 [00:37<00:08,  2.05it/s, TrL=0.12, TrR=0.3207, TrR²=0.136, Best=0.3207, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  82%|████████▏ | 82/100 [00:37<00:08,  2.05it/s, TrL=0.12, TrR=0.3196, TrR²=0.142, Best=0.3196, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  83%|████████▎ | 83/100 [00:37<00:08,  2.10it/s, TrL=0.12, TrR=0.3196, TrR²=0.142, Best=0.3196, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  83%|████████▎ | 83/100 [00:38<00:08,  2.10it/s, TrL=0.12, TrR=0.3185, TrR²=0.148, Best=0.3185, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  84%|████████▍ | 84/100 [00:38<00:07,  2.12it/s, TrL=0.12, TrR=0.3185, TrR²=0.148, Best=0.3185, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  84%|████████▍ | 84/100 [00:38<00:07,  2.12it/s, TrL=0.12, TrR=0.3175, TrR²=0.153, Best=0.3175, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  85%|████████▌ | 85/100 [00:38<00:06,  2.17it/s, TrL=0.12, TrR=0.3175, TrR²=0.153, Best=0.3175, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  85%|████████▌ | 85/100 [00:39<00:06,  2.17it/s, TrL=0.12, TrR=0.3165, TrR²=0.158, Best=0.3165, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  86%|████████▌ | 86/100 [00:39<00:06,  2.20it/s, TrL=0.12, TrR=0.3165, TrR²=0.158, Best=0.3165, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  86%|████████▌ | 86/100 [00:39<00:06,  2.20it/s, TrL=0.12, TrR=0.3156, TrR²=0.164, Best=0.3156, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  87%|████████▋ | 87/100 [00:39<00:05,  2.23it/s, TrL=0.12, TrR=0.3156, TrR²=0.164, Best=0.3156, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  87%|████████▋ | 87/100 [00:39<00:05,  2.23it/s, TrL=0.12, TrR=0.3146, TrR²=0.169, Best=0.3146, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  88%|████████▊ | 88/100 [00:39<00:05,  2.27it/s, TrL=0.12, TrR=0.3146, TrR²=0.169, Best=0.3146, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  88%|████████▊ | 88/100 [00:40<00:05,  2.27it/s, TrL=0.12, TrR=0.3137, TrR²=0.173, Best=0.3137, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  89%|████████▉ | 89/100 [00:40<00:04,  2.29it/s, TrL=0.12, TrR=0.3137, TrR²=0.173, Best=0.3137, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  89%|████████▉ | 89/100 [00:40<00:04,  2.29it/s, TrL=0.11, TrR=0.3128, TrR²=0.178, Best=0.3128, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  90%|█████████ | 90/100 [00:40<00:04,  2.33it/s, TrL=0.11, TrR=0.3128, TrR²=0.178, Best=0.3128, HoL=0.2, HoR=0.6321, HoR²=-0.603]Training:  90%|█████████ | 90/100 [00:41<00:04,  2.33it/s, TrL=0.12, TrR=0.3119, TrR²=0.183, Best=0.3128, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  91%|█████████ | 91/100 [00:41<00:03,  2.29it/s, TrL=0.12, TrR=0.3119, TrR²=0.183, Best=0.3128, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  91%|█████████ | 91/100 [00:41<00:03,  2.29it/s, TrL=0.12, TrR=0.3110, TrR²=0.187, Best=0.3110, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  92%|█████████▏| 92/100 [00:41<00:03,  2.30it/s, TrL=0.12, TrR=0.3110, TrR²=0.187, Best=0.3110, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  92%|█████████▏| 92/100 [00:42<00:03,  2.30it/s, TrL=0.12, TrR=0.3102, TrR²=0.192, Best=0.3102, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  93%|█████████▎| 93/100 [00:42<00:03,  2.30it/s, TrL=0.12, TrR=0.3102, TrR²=0.192, Best=0.3102, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  93%|█████████▎| 93/100 [00:42<00:03,  2.30it/s, TrL=0.12, TrR=0.3093, TrR²=0.196, Best=0.3093, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  94%|█████████▍| 94/100 [00:42<00:02,  2.25it/s, TrL=0.12, TrR=0.3093, TrR²=0.196, Best=0.3093, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  94%|█████████▍| 94/100 [00:43<00:02,  2.25it/s, TrL=0.11, TrR=0.3085, TrR²=0.201, Best=0.3085, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  95%|█████████▌| 95/100 [00:43<00:02,  2.22it/s, TrL=0.11, TrR=0.3085, TrR²=0.201, Best=0.3085, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  95%|█████████▌| 95/100 [00:43<00:02,  2.22it/s, TrL=0.11, TrR=0.3077, TrR²=0.205, Best=0.3077, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  96%|█████████▌| 96/100 [00:43<00:01,  2.11it/s, TrL=0.11, TrR=0.3077, TrR²=0.205, Best=0.3077, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  96%|█████████▌| 96/100 [00:44<00:01,  2.11it/s, TrL=0.11, TrR=0.3069, TrR²=0.209, Best=0.3069, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  97%|█████████▋| 97/100 [00:44<00:01,  2.17it/s, TrL=0.11, TrR=0.3069, TrR²=0.209, Best=0.3069, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  97%|█████████▋| 97/100 [00:44<00:01,  2.17it/s, TrL=0.11, TrR=0.3061, TrR²=0.213, Best=0.3061, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  98%|█████████▊| 98/100 [00:44<00:00,  2.20it/s, TrL=0.11, TrR=0.3061, TrR²=0.213, Best=0.3061, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  98%|█████████▊| 98/100 [00:45<00:00,  2.20it/s, TrL=0.11, TrR=0.3054, TrR²=0.217, Best=0.3054, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  99%|█████████▉| 99/100 [00:45<00:00,  1.96it/s, TrL=0.11, TrR=0.3054, TrR²=0.217, Best=0.3054, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training:  99%|█████████▉| 99/100 [00:45<00:00,  1.96it/s, TrL=0.11, TrR=0.3046, TrR²=0.221, Best=0.3046, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training: 100%|██████████| 100/100 [00:45<00:00,  2.08it/s, TrL=0.11, TrR=0.3046, TrR²=0.221, Best=0.3046, HoL=0.2, HoR=0.5935, HoR²=-0.413]Training: 100%|██████████| 100/100 [00:45<00:00,  2.20it/s, TrL=0.11, TrR=0.3046, TrR²=0.221, Best=0.3046, HoL=0.2, HoR=0.5935, HoR²=-0.413]
================================================================================

TEST RESULTS:
================================================================================
Training R²: 0.9155
Training RMSE (orig): 439,732
Holdout R²: 0.2205
Holdout RMSE (orig): 1,085,162
R² Gap: 0.6950

================================================================================
TESTING ATTRIBUTION (Simple Additivity Check)
================================================================================

Component shapes (scaled space):
  Predictions: torch.Size([190, 107])
  Baseline: torch.Size([190, 107])
  Media: torch.Size([190, 107, 13])
  Controls: torch.Size([190, 107, 7])
  Seasonal: torch.Size([190, 107])
  Trend: torch.Size([190, 107])
  Prediction scale: 0.5000

Additivity Check (Original Scale):
  Mean prediction: 832,608
  Mean components sum: 832,608
  Mean absolute difference: 0.04
  Max absolute difference: 1.99
  Relative error: 0.0000%
  ✓ PASS: Components sum to predictions (additive!)

Attribution (% of total):
  Media: 16.8%
  Baseline: 45.2%
  Controls: -6.4%
  Seasonality: 27.3%
  Trend: 17.1%
  Total: 100.0%
  ? Media attribution is 16.8% (expected ~40%)

================================================================================
TEST COMPLETE!
================================================================================

Next steps:
1. If test passes, run full 2500 epochs
2. Verify attribution stays ~40% with full training
3. Compare with log-space results
================================================================================
