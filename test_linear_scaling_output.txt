/opt/homebrew/anaconda3/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.8.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/opt/homebrew/anaconda3/lib/python3.9/site-packages/pandas/core/arrays/masked.py:61: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.5' currently installed).
  from pandas.core import (
/Users/adityapu/Documents/GitHub/deepcausalmmm/test_linear_scaling_100epochs.py:60: FutureWarning: SeriesGroupBy.fillna is deprecated and will be removed in a future version. Use obj.ffill() or obj.bfill() for forward or backward filling instead. If you want to fill with a single value, use Series.fillna instead
  df_complete[col] = df_complete.groupby(region_col)[col].fillna(method='ffill').fillna(method='bfill')
/Users/adityapu/Documents/GitHub/deepcausalmmm/test_linear_scaling_100epochs.py:60: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df_complete[col] = df_complete.groupby(region_col)[col].fillna(method='ffill').fillna(method='bfill')
================================================================================
TESTING LINEAR SCALING IMPLEMENTATION (y/mean)
================================================================================
Running quick 100-epoch test to verify architecture changes

Loading data...
Data: 190 regions × 109 weeks
Media channels: 13
Control variables: 7
Visits range: 0 - 15,778,575
Visits mean: 743,088

Creating configuration (100 epochs for quick test)...
Epochs: 100

Processing data with UnifiedDataPipeline...
WARNING -    WARNING: Holdout weeks (8) is small relative to burn-in weeks (6)
WARNING -    Note: Burn-in is added as padding, all 8 actual weeks will be evaluated
INFO - 
 Unified Data Pipeline - Time Series Split (Ratio-Based):
INFO -     Training: 101 actual weeks (weeks 1-101) - 92.7%
INFO -     Holdout: 8 actual weeks (weeks 102-109) - 7.3%
INFO -     Burn-in Padding: 6 weeks will be added to BOTH train and holdout
INFO -     Model sees: Train 107 weeks, Holdout 14 weeks
INFO -     Evaluation: Remove 6 padding weeks, evaluate on ALL actual data
INFO -     Time series approach: Training on historical data, testing on most recent data
Train weeks: 101
Holdout weeks: 101
INFO - 
 Unified Data Pipeline - Processing Training Data:
INFO -     Adding seasonality features to training data...
INFO -     Seasonality now handled by model's data-driven seasonal decomposition (not as control variable)
INFO -    Training data processed:
INFO -    Shape: 190 regions × 107 weeks
INFO -    Media channels: 13
INFO -    Control variables: 7 (seasonality now handled by model baseline)
INFO -    Scaler fitted on training data only
INFO -    Added 6 weeks padding
INFO - 
 Unified Data Pipeline - Processing Holdout Data:
INFO -    Adding seasonality features to holdout data BEFORE scaling...
INFO -     Seasonality now handled by model's data-driven seasonal decomposition (not as control variable)
INFO -    Holdout data processed with IDENTICAL transformations:
INFO -    Shape: 190 regions × 14 weeks
INFO -    Media channels: 13
INFO -    Control variables: 7 (seasonality now handled by model baseline)
INFO -    Used SAME scaler as training (no data leakage)
INFO -    Added SAME 6 weeks padding
Processed shapes:
  X_media: torch.Size([190, 107, 13])
  X_control: torch.Size([190, 107, 7])
  y: torch.Size([190, 107])

Linear scaling active:
  y_mean_per_region shape: torch.Size([190, 1])
  y_mean_per_region range: [0, 13649089]
  y_mean_per_region mean: 839764

Creating model...
Model created with 320 hidden units

Training for 100 epochs...
================================================================================
INFO - Initialized baselines (Linear scaled - y/mean):
INFO -    Region baselines range: [1.000, 1.000]
INFO -    Global bias (Linear scale): 0.000 [LEARNABLE - constrained ≥ 0 via softplus]
INFO -    Expected prediction baseline: 1.000 (normalized) -> ~839764 visits
INFO -  Extracting seasonal components per region...
INFO -     Processing 190 regions × 101 weeks
INFO -     Seasonal components extracted:
INFO -       Range: [-3393321.750, 1957011.250]
INFO -       Mean: 523.267
INFO -       Shape: torch.Size([190, 101])
INFO -  Initialized seasonal components:
INFO -    Seasonal coefficient: 1.000 [LEARNABLE - constrained ≥ 0 via softplus]
INFO -    Components range: [0.000, 1.000] (Min-Max scaled per region)
INFO -    Components mean: 0.531
INFO -    Scaling: Min-Max per region (0-1 range) - preserves seasonal patterns
INFO - Initialized stable coefficients from data:
INFO -   Media coeff range (POSITIVE-ONLY): [0.7052, 0.8937]
INFO -   Control coeff range: [-0.9588, 0.5716]
INFO - 
Warm-start Training (50 epochs)...
Warm-start:   0%|          | 0/50 [00:00<?, ?it/s]Warm-start:   0%|          | 0/50 [00:00<?, ?it/s, Loss=9.8782]Warm-start:   2%|▏         | 1/50 [00:00<00:27,  1.79it/s, Loss=9.8782]Warm-start:   2%|▏         | 1/50 [00:00<00:27,  1.79it/s, Loss=9.8413]Warm-start:   4%|▍         | 2/50 [00:00<00:23,  2.08it/s, Loss=9.8413]Warm-start:   4%|▍         | 2/50 [00:01<00:23,  2.08it/s, Loss=9.8044]Warm-start:   6%|▌         | 3/50 [00:01<00:21,  2.21it/s, Loss=9.8044]Warm-start:   6%|▌         | 3/50 [00:01<00:21,  2.21it/s, Loss=9.7674]Warm-start:   8%|▊         | 4/50 [00:01<00:21,  2.19it/s, Loss=9.7674]Warm-start:   8%|▊         | 4/50 [00:02<00:21,  2.19it/s, Loss=9.7300]Warm-start:  10%|█         | 5/50 [00:02<00:19,  2.25it/s, Loss=9.7300]Warm-start:  10%|█         | 5/50 [00:02<00:19,  2.25it/s, Loss=9.6920]Warm-start:  12%|█▏        | 6/50 [00:02<00:19,  2.30it/s, Loss=9.6920]Warm-start:  12%|█▏        | 6/50 [00:03<00:19,  2.30it/s, Loss=9.6533]Warm-start:  14%|█▍        | 7/50 [00:03<00:18,  2.27it/s, Loss=9.6533]Warm-start:  14%|█▍        | 7/50 [00:03<00:18,  2.27it/s, Loss=9.6135]Warm-start:  16%|█▌        | 8/50 [00:03<00:18,  2.29it/s, Loss=9.6135]Warm-start:  16%|█▌        | 8/50 [00:04<00:18,  2.29it/s, Loss=9.5726]Warm-start:  18%|█▊        | 9/50 [00:04<00:17,  2.32it/s, Loss=9.5726]Warm-start:  18%|█▊        | 9/50 [00:04<00:17,  2.32it/s, Loss=9.5303]Warm-start:  20%|██        | 10/50 [00:04<00:17,  2.31it/s, Loss=9.5303]Warm-start:  20%|██        | 10/50 [00:04<00:17,  2.31it/s, Loss=9.4865]Warm-start:  22%|██▏       | 11/50 [00:04<00:17,  2.29it/s, Loss=9.4865]Warm-start:  22%|██▏       | 11/50 [00:05<00:17,  2.29it/s, Loss=9.4409]Warm-start:  24%|██▍       | 12/50 [00:05<00:16,  2.28it/s, Loss=9.4409]Warm-start:  24%|██▍       | 12/50 [00:05<00:16,  2.28it/s, Loss=9.3933]Warm-start:  26%|██▌       | 13/50 [00:05<00:16,  2.25it/s, Loss=9.3933]Warm-start:  26%|██▌       | 13/50 [00:06<00:16,  2.25it/s, Loss=9.3433]Warm-start:  28%|██▊       | 14/50 [00:06<00:15,  2.27it/s, Loss=9.3433]Warm-start:  28%|██▊       | 14/50 [00:06<00:15,  2.27it/s, Loss=9.2906]Warm-start:  30%|███       | 15/50 [00:06<00:16,  2.16it/s, Loss=9.2906]Warm-start:  30%|███       | 15/50 [00:07<00:16,  2.16it/s, Loss=9.2350]Warm-start:  32%|███▏      | 16/50 [00:07<00:16,  2.08it/s, Loss=9.2350]Warm-start:  32%|███▏      | 16/50 [00:07<00:16,  2.08it/s, Loss=9.1760]Warm-start:  34%|███▍      | 17/50 [00:07<00:15,  2.18it/s, Loss=9.1760]Warm-start:  34%|███▍      | 17/50 [00:08<00:15,  2.18it/s, Loss=9.1129]Warm-start:  36%|███▌      | 18/50 [00:08<00:14,  2.28it/s, Loss=9.1129]Warm-start:  36%|███▌      | 18/50 [00:08<00:14,  2.28it/s, Loss=9.0461]Warm-start:  38%|███▊      | 19/50 [00:08<00:13,  2.33it/s, Loss=9.0461]Warm-start:  38%|███▊      | 19/50 [00:08<00:13,  2.33it/s, Loss=8.9744]Warm-start:  40%|████      | 20/50 [00:08<00:13,  2.30it/s, Loss=8.9744]Warm-start:  40%|████      | 20/50 [00:09<00:13,  2.30it/s, Loss=8.8979]Warm-start:  42%|████▏     | 21/50 [00:09<00:12,  2.30it/s, Loss=8.8979]Warm-start:  42%|████▏     | 21/50 [00:09<00:12,  2.30it/s, Loss=8.8159]Warm-start:  44%|████▍     | 22/50 [00:09<00:12,  2.31it/s, Loss=8.8159]Warm-start:  44%|████▍     | 22/50 [00:10<00:12,  2.31it/s, Loss=8.7284]Warm-start:  46%|████▌     | 23/50 [00:10<00:11,  2.32it/s, Loss=8.7284]Warm-start:  46%|████▌     | 23/50 [00:10<00:11,  2.32it/s, Loss=8.6348]Warm-start:  48%|████▊     | 24/50 [00:10<00:11,  2.24it/s, Loss=8.6348]Warm-start:  48%|████▊     | 24/50 [00:11<00:11,  2.24it/s, Loss=8.5355]Warm-start:  50%|█████     | 25/50 [00:11<00:11,  2.23it/s, Loss=8.5355]Warm-start:  50%|█████     | 25/50 [00:11<00:11,  2.23it/s, Loss=8.4289]Warm-start:  52%|█████▏    | 26/50 [00:11<00:10,  2.25it/s, Loss=8.4289]Warm-start:  52%|█████▏    | 26/50 [00:12<00:10,  2.25it/s, Loss=8.3171]Warm-start:  54%|█████▍    | 27/50 [00:12<00:10,  2.23it/s, Loss=8.3171]Warm-start:  54%|█████▍    | 27/50 [00:12<00:10,  2.23it/s, Loss=8.2004]Warm-start:  56%|█████▌    | 28/50 [00:12<00:10,  2.19it/s, Loss=8.2004]Warm-start:  56%|█████▌    | 28/50 [00:12<00:10,  2.19it/s, Loss=8.0799]Warm-start:  58%|█████▊    | 29/50 [00:12<00:09,  2.23it/s, Loss=8.0799]Warm-start:  58%|█████▊    | 29/50 [00:13<00:09,  2.23it/s, Loss=7.9560]Warm-start:  60%|██████    | 30/50 [00:13<00:08,  2.22it/s, Loss=7.9560]Warm-start:  60%|██████    | 30/50 [00:13<00:08,  2.22it/s, Loss=7.8315]Warm-start:  62%|██████▏   | 31/50 [00:13<00:08,  2.24it/s, Loss=7.8315]Warm-start:  62%|██████▏   | 31/50 [00:14<00:08,  2.24it/s, Loss=7.7107]Warm-start:  64%|██████▍   | 32/50 [00:14<00:08,  2.24it/s, Loss=7.7107]Warm-start:  64%|██████▍   | 32/50 [00:14<00:08,  2.24it/s, Loss=7.5955]Warm-start:  66%|██████▌   | 33/50 [00:14<00:07,  2.23it/s, Loss=7.5955]Warm-start:  66%|██████▌   | 33/50 [00:15<00:07,  2.23it/s, Loss=7.4893]Warm-start:  68%|██████▊   | 34/50 [00:15<00:08,  1.96it/s, Loss=7.4893]Warm-start:  68%|██████▊   | 34/50 [00:15<00:08,  1.96it/s, Loss=7.3956]Warm-start:  70%|███████   | 35/50 [00:15<00:07,  2.02it/s, Loss=7.3956]Warm-start:  70%|███████   | 35/50 [00:16<00:07,  2.02it/s, Loss=7.3149]Warm-start:  72%|███████▏  | 36/50 [00:16<00:06,  2.11it/s, Loss=7.3149]Warm-start:  72%|███████▏  | 36/50 [00:16<00:06,  2.11it/s, Loss=7.2408]Warm-start:  74%|███████▍  | 37/50 [00:16<00:06,  2.15it/s, Loss=7.2408]Warm-start:  74%|███████▍  | 37/50 [00:17<00:06,  2.15it/s, Loss=7.1707]Warm-start:  76%|███████▌  | 38/50 [00:17<00:05,  2.19it/s, Loss=7.1707]Warm-start:  76%|███████▌  | 38/50 [00:17<00:05,  2.19it/s, Loss=7.0919]Warm-start:  78%|███████▊  | 39/50 [00:17<00:04,  2.21it/s, Loss=7.0919]Warm-start:  78%|███████▊  | 39/50 [00:18<00:04,  2.21it/s, Loss=6.9994]Warm-start:  80%|████████  | 40/50 [00:18<00:04,  2.23it/s, Loss=6.9994]Warm-start:  80%|████████  | 40/50 [00:18<00:04,  2.23it/s, Loss=6.8881]Warm-start:  82%|████████▏ | 41/50 [00:18<00:04,  2.25it/s, Loss=6.8881]Warm-start:  82%|████████▏ | 41/50 [00:18<00:04,  2.25it/s, Loss=6.7596]Warm-start:  84%|████████▍ | 42/50 [00:18<00:03,  2.23it/s, Loss=6.7596]Warm-start:  84%|████████▍ | 42/50 [00:19<00:03,  2.23it/s, Loss=6.6165]Warm-start:  86%|████████▌ | 43/50 [00:19<00:03,  2.26it/s, Loss=6.6165]Warm-start:  86%|████████▌ | 43/50 [00:19<00:03,  2.26it/s, Loss=6.4568]Warm-start:  88%|████████▊ | 44/50 [00:19<00:02,  2.28it/s, Loss=6.4568]Warm-start:  88%|████████▊ | 44/50 [00:20<00:02,  2.28it/s, Loss=6.2886]Warm-start:  90%|█████████ | 45/50 [00:20<00:02,  2.27it/s, Loss=6.2886]Warm-start:  90%|█████████ | 45/50 [00:20<00:02,  2.27it/s, Loss=6.1096]Warm-start:  92%|█████████▏| 46/50 [00:20<00:01,  2.27it/s, Loss=6.1096]Warm-start:  92%|█████████▏| 46/50 [00:21<00:01,  2.27it/s, Loss=5.9186]Warm-start:  94%|█████████▍| 47/50 [00:21<00:01,  2.27it/s, Loss=5.9186]Warm-start:  94%|█████████▍| 47/50 [00:21<00:01,  2.27it/s, Loss=5.7181]Warm-start:  96%|█████████▌| 48/50 [00:21<00:00,  2.28it/s, Loss=5.7181]Warm-start:  96%|█████████▌| 48/50 [00:21<00:00,  2.28it/s, Loss=5.5064]Warm-start:  98%|█████████▊| 49/50 [00:21<00:00,  2.27it/s, Loss=5.5064]Warm-start:  98%|█████████▊| 49/50 [00:22<00:00,  2.27it/s, Loss=5.2851]Warm-start: 100%|██████████| 50/50 [00:22<00:00,  2.25it/s, Loss=5.2851]                                                                        INFO - 
 Main Training (100 epochs)...
Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   0%|          | 0/100 [00:00<?, ?it/s, TrL=1.78, TrR=1.9219, TrR²=-30.023, Best=2.7280, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   1%|          | 1/100 [00:00<00:47,  2.08it/s, TrL=1.78, TrR=1.9219, TrR²=-30.023, Best=2.7280, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   1%|          | 1/100 [00:00<00:47,  2.08it/s, TrL=1.61, TrR=2.8044, TrR²=-65.056, Best=2.7280, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   2%|▏         | 2/100 [00:00<00:45,  2.15it/s, TrL=1.61, TrR=2.8044, TrR²=-65.056, Best=2.7280, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   2%|▏         | 2/100 [00:01<00:45,  2.15it/s, TrL=1.23, TrR=2.1317, TrR²=-37.169, Best=2.1317, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   3%|▎         | 3/100 [00:01<00:43,  2.21it/s, TrL=1.23, TrR=2.1317, TrR²=-37.169, Best=2.1317, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   3%|▎         | 3/100 [00:01<00:43,  2.21it/s, TrL=1.09, TrR=2.3628, TrR²=-45.890, Best=2.1317, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   4%|▍         | 4/100 [00:01<00:49,  1.92it/s, TrL=1.09, TrR=2.3628, TrR²=-45.890, Best=2.1317, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   4%|▍         | 4/100 [00:02<00:49,  1.92it/s, TrL=0.87, TrR=1.9952, TrR²=-32.437, Best=1.9952, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   5%|▌         | 5/100 [00:02<00:48,  1.95it/s, TrL=0.87, TrR=1.9952, TrR²=-32.437, Best=1.9952, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   5%|▌         | 5/100 [00:02<00:48,  1.95it/s, TrL=0.84, TrR=1.9046, TrR²=-29.469, Best=1.9046, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   6%|▌         | 6/100 [00:02<00:45,  2.06it/s, TrL=0.84, TrR=1.9046, TrR²=-29.469, Best=1.9046, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   6%|▌         | 6/100 [00:03<00:45,  2.06it/s, TrL=0.78, TrR=1.3661, TrR²=-14.674, Best=1.3661, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   7%|▋         | 7/100 [00:03<00:44,  2.11it/s, TrL=0.78, TrR=1.3661, TrR²=-14.674, Best=1.3661, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   7%|▋         | 7/100 [00:03<00:44,  2.11it/s, TrL=0.88, TrR=1.7766, TrR²=-25.512, Best=1.3661, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   8%|▊         | 8/100 [00:03<00:42,  2.17it/s, TrL=0.88, TrR=1.7766, TrR²=-25.512, Best=1.3661, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   8%|▊         | 8/100 [00:04<00:42,  2.17it/s, TrL=0.87, TrR=1.6466, TrR²=-21.772, Best=1.3661, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   9%|▉         | 9/100 [00:04<00:41,  2.20it/s, TrL=0.87, TrR=1.6466, TrR²=-21.772, Best=1.3661, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:   9%|▉         | 9/100 [00:04<00:41,  2.20it/s, TrL=0.86, TrR=1.3929, TrR²=-15.297, Best=1.3661, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:  10%|█         | 10/100 [00:04<00:41,  2.19it/s, TrL=0.86, TrR=1.3929, TrR²=-15.297, Best=1.3661, HoL=1.5, HoR=2.7280, HoR²=-10.000]Training:  10%|█         | 10/100 [00:05<00:41,  2.19it/s, TrL=0.79, TrR=1.1943, TrR²=-10.980, Best=1.3661, HoL=0.7, HoR=1.5254, HoR²=-8.333] Training:  11%|█         | 11/100 [00:05<00:40,  2.19it/s, TrL=0.79, TrR=1.1943, TrR²=-10.980, Best=1.3661, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  11%|█         | 11/100 [00:05<00:40,  2.19it/s, TrL=0.73, TrR=1.0675, TrR²=-8.571, Best=1.0675, HoL=0.7, HoR=1.5254, HoR²=-8.333] Training:  12%|█▏        | 12/100 [00:05<00:39,  2.21it/s, TrL=0.73, TrR=1.0675, TrR²=-8.571, Best=1.0675, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  12%|█▏        | 12/100 [00:06<00:39,  2.21it/s, TrL=0.69, TrR=0.9393, TrR²=-6.410, Best=0.9393, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  13%|█▎        | 13/100 [00:06<00:38,  2.24it/s, TrL=0.69, TrR=0.9393, TrR²=-6.410, Best=0.9393, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  13%|█▎        | 13/100 [00:06<00:38,  2.24it/s, TrL=0.69, TrR=1.0278, TrR²=-7.872, Best=0.9393, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  14%|█▍        | 14/100 [00:06<00:38,  2.26it/s, TrL=0.69, TrR=1.0278, TrR²=-7.872, Best=0.9393, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  14%|█▍        | 14/100 [00:06<00:38,  2.26it/s, TrL=0.65, TrR=0.8590, TrR²=-5.198, Best=0.8590, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  15%|█▌        | 15/100 [00:06<00:37,  2.26it/s, TrL=0.65, TrR=0.8590, TrR²=-5.198, Best=0.8590, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  15%|█▌        | 15/100 [00:07<00:37,  2.26it/s, TrL=0.59, TrR=0.7133, TrR²=-3.274, Best=0.7133, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  16%|█▌        | 16/100 [00:07<00:37,  2.24it/s, TrL=0.59, TrR=0.7133, TrR²=-3.274, Best=0.7133, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  16%|█▌        | 16/100 [00:07<00:37,  2.24it/s, TrL=0.55, TrR=0.6642, TrR²=-2.705, Best=0.6642, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  17%|█▋        | 17/100 [00:07<00:38,  2.17it/s, TrL=0.55, TrR=0.6642, TrR²=-2.705, Best=0.6642, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  17%|█▋        | 17/100 [00:08<00:38,  2.17it/s, TrL=0.52, TrR=0.6649, TrR²=-2.713, Best=0.6642, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  18%|█▊        | 18/100 [00:08<00:37,  2.19it/s, TrL=0.52, TrR=0.6649, TrR²=-2.713, Best=0.6642, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  18%|█▊        | 18/100 [00:08<00:37,  2.19it/s, TrL=0.51, TrR=0.6439, TrR²=-2.483, Best=0.6439, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  19%|█▉        | 19/100 [00:08<00:36,  2.23it/s, TrL=0.51, TrR=0.6439, TrR²=-2.483, Best=0.6439, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  19%|█▉        | 19/100 [00:09<00:36,  2.23it/s, TrL=0.51, TrR=0.6319, TrR²=-2.354, Best=0.6319, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  20%|██        | 20/100 [00:09<00:36,  2.22it/s, TrL=0.51, TrR=0.6319, TrR²=-2.354, Best=0.6319, HoL=0.7, HoR=1.5254, HoR²=-8.333]Training:  20%|██        | 20/100 [00:09<00:36,  2.22it/s, TrL=0.49, TrR=0.6192, TrR²=-2.221, Best=0.6319, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  21%|██        | 21/100 [00:09<00:35,  2.20it/s, TrL=0.49, TrR=0.6192, TrR²=-2.221, Best=0.6319, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  21%|██        | 21/100 [00:10<00:35,  2.20it/s, TrL=0.46, TrR=0.5973, TrR²=-1.997, Best=0.5973, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  22%|██▏       | 22/100 [00:10<00:35,  2.22it/s, TrL=0.46, TrR=0.5973, TrR²=-1.997, Best=0.5973, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  22%|██▏       | 22/100 [00:10<00:35,  2.22it/s, TrL=0.43, TrR=0.5852, TrR²=-1.876, Best=0.5852, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  23%|██▎       | 23/100 [00:10<00:34,  2.22it/s, TrL=0.43, TrR=0.5852, TrR²=-1.876, Best=0.5852, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  23%|██▎       | 23/100 [00:10<00:34,  2.22it/s, TrL=0.40, TrR=0.5710, TrR²=-1.739, Best=0.5710, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  24%|██▍       | 24/100 [00:10<00:33,  2.24it/s, TrL=0.40, TrR=0.5710, TrR²=-1.739, Best=0.5710, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  24%|██▍       | 24/100 [00:11<00:33,  2.24it/s, TrL=0.39, TrR=0.5582, TrR²=-1.617, Best=0.5582, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  25%|██▌       | 25/100 [00:11<00:33,  2.24it/s, TrL=0.39, TrR=0.5582, TrR²=-1.617, Best=0.5582, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  25%|██▌       | 25/100 [00:11<00:33,  2.24it/s, TrL=0.37, TrR=0.5461, TrR²=-1.505, Best=0.5461, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  26%|██▌       | 26/100 [00:11<00:32,  2.26it/s, TrL=0.37, TrR=0.5461, TrR²=-1.505, Best=0.5461, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  26%|██▌       | 26/100 [00:12<00:32,  2.26it/s, TrL=0.35, TrR=0.5420, TrR²=-1.467, Best=0.5420, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  27%|██▋       | 27/100 [00:12<00:32,  2.24it/s, TrL=0.35, TrR=0.5420, TrR²=-1.467, Best=0.5420, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  27%|██▋       | 27/100 [00:12<00:32,  2.24it/s, TrL=0.34, TrR=0.5281, TrR²=-1.343, Best=0.5281, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  28%|██▊       | 28/100 [00:12<00:31,  2.26it/s, TrL=0.34, TrR=0.5281, TrR²=-1.343, Best=0.5281, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  28%|██▊       | 28/100 [00:13<00:31,  2.26it/s, TrL=0.33, TrR=0.5155, TrR²=-1.232, Best=0.5155, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  29%|██▉       | 29/100 [00:13<00:31,  2.28it/s, TrL=0.33, TrR=0.5155, TrR²=-1.232, Best=0.5155, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  29%|██▉       | 29/100 [00:13<00:31,  2.28it/s, TrL=0.32, TrR=0.5080, TrR²=-1.168, Best=0.5080, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  30%|███       | 30/100 [00:13<00:30,  2.27it/s, TrL=0.32, TrR=0.5080, TrR²=-1.168, Best=0.5080, HoL=0.5, HoR=1.2695, HoR²=-5.464]Training:  30%|███       | 30/100 [00:14<00:30,  2.27it/s, TrL=0.31, TrR=0.4983, TrR²=-1.086, Best=0.5080, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  31%|███       | 31/100 [00:14<00:30,  2.23it/s, TrL=0.31, TrR=0.4983, TrR²=-1.086, Best=0.5080, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  31%|███       | 31/100 [00:14<00:30,  2.23it/s, TrL=0.30, TrR=0.4914, TrR²=-1.028, Best=0.4914, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  32%|███▏      | 32/100 [00:14<00:30,  2.24it/s, TrL=0.30, TrR=0.4914, TrR²=-1.028, Best=0.4914, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  32%|███▏      | 32/100 [00:14<00:30,  2.24it/s, TrL=0.28, TrR=0.4808, TrR²=-0.942, Best=0.4808, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  33%|███▎      | 33/100 [00:14<00:29,  2.26it/s, TrL=0.28, TrR=0.4808, TrR²=-0.942, Best=0.4808, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  33%|███▎      | 33/100 [00:15<00:29,  2.26it/s, TrL=0.27, TrR=0.4735, TrR²=-0.883, Best=0.4735, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  34%|███▍      | 34/100 [00:15<00:29,  2.27it/s, TrL=0.27, TrR=0.4735, TrR²=-0.883, Best=0.4735, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  34%|███▍      | 34/100 [00:15<00:29,  2.27it/s, TrL=0.26, TrR=0.4653, TrR²=-0.819, Best=0.4653, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  35%|███▌      | 35/100 [00:15<00:28,  2.26it/s, TrL=0.26, TrR=0.4653, TrR²=-0.819, Best=0.4653, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  35%|███▌      | 35/100 [00:16<00:28,  2.26it/s, TrL=0.25, TrR=0.4606, TrR²=-0.782, Best=0.4606, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  36%|███▌      | 36/100 [00:16<00:28,  2.26it/s, TrL=0.25, TrR=0.4606, TrR²=-0.782, Best=0.4606, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  36%|███▌      | 36/100 [00:16<00:28,  2.26it/s, TrL=0.25, TrR=0.4566, TrR²=-0.751, Best=0.4566, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  37%|███▋      | 37/100 [00:16<00:27,  2.28it/s, TrL=0.25, TrR=0.4566, TrR²=-0.751, Best=0.4566, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  37%|███▋      | 37/100 [00:17<00:27,  2.28it/s, TrL=0.24, TrR=0.4476, TrR²=-0.683, Best=0.4476, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  38%|███▊      | 38/100 [00:17<00:27,  2.28it/s, TrL=0.24, TrR=0.4476, TrR²=-0.683, Best=0.4476, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  38%|███▊      | 38/100 [00:17<00:27,  2.28it/s, TrL=0.23, TrR=0.4407, TrR²=-0.631, Best=0.4407, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  39%|███▉      | 39/100 [00:17<00:32,  1.88it/s, TrL=0.23, TrR=0.4407, TrR²=-0.631, Best=0.4407, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  39%|███▉      | 39/100 [00:18<00:32,  1.88it/s, TrL=0.23, TrR=0.4357, TrR²=-0.594, Best=0.4357, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  40%|████      | 40/100 [00:18<00:30,  1.94it/s, TrL=0.23, TrR=0.4357, TrR²=-0.594, Best=0.4357, HoL=0.3, HoR=1.0793, HoR²=-3.673]Training:  40%|████      | 40/100 [00:18<00:30,  1.94it/s, TrL=0.22, TrR=0.4327, TrR²=-0.573, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  41%|████      | 41/100 [00:18<00:29,  2.01it/s, TrL=0.22, TrR=0.4327, TrR²=-0.573, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  41%|████      | 41/100 [00:19<00:29,  2.01it/s, TrL=0.23, TrR=0.4890, TrR²=-1.008, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  42%|████▏     | 42/100 [00:19<00:27,  2.09it/s, TrL=0.23, TrR=0.4890, TrR²=-1.008, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  42%|████▏     | 42/100 [00:19<00:27,  2.09it/s, TrL=0.28, TrR=0.7502, TrR²=-3.727, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  43%|████▎     | 43/100 [00:19<00:26,  2.15it/s, TrL=0.28, TrR=0.7502, TrR²=-3.727, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  43%|████▎     | 43/100 [00:20<00:26,  2.15it/s, TrL=0.28, TrR=0.6070, TrR²=-2.095, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  44%|████▍     | 44/100 [00:20<00:25,  2.18it/s, TrL=0.28, TrR=0.6070, TrR²=-2.095, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  44%|████▍     | 44/100 [00:20<00:25,  2.18it/s, TrL=0.30, TrR=0.6136, TrR²=-2.162, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  45%|████▌     | 45/100 [00:20<00:24,  2.20it/s, TrL=0.30, TrR=0.6136, TrR²=-2.162, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  45%|████▌     | 45/100 [00:21<00:24,  2.20it/s, TrL=0.33, TrR=0.8377, TrR²=-4.895, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  46%|████▌     | 46/100 [00:21<00:24,  2.23it/s, TrL=0.33, TrR=0.8377, TrR²=-4.895, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  46%|████▌     | 46/100 [00:21<00:24,  2.23it/s, TrL=0.29, TrR=0.4423, TrR²=-0.643, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  47%|████▋     | 47/100 [00:21<00:23,  2.24it/s, TrL=0.29, TrR=0.4423, TrR²=-0.643, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  47%|████▋     | 47/100 [00:21<00:23,  2.24it/s, TrL=0.30, TrR=0.4645, TrR²=-0.812, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  48%|████▊     | 48/100 [00:21<00:23,  2.25it/s, TrL=0.30, TrR=0.4645, TrR²=-0.812, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  48%|████▊     | 48/100 [00:22<00:23,  2.25it/s, TrL=0.31, TrR=0.5042, TrR²=-1.136, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  49%|████▉     | 49/100 [00:22<00:22,  2.28it/s, TrL=0.31, TrR=0.5042, TrR²=-1.136, Best=0.4357, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  49%|████▉     | 49/100 [00:22<00:22,  2.28it/s, TrL=0.29, TrR=0.3999, TrR²=-0.343, Best=0.3999, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  50%|█████     | 50/100 [00:22<00:22,  2.27it/s, TrL=0.29, TrR=0.3999, TrR²=-0.343, Best=0.3999, HoL=0.3, HoR=0.9609, HoR²=-2.704]Training:  50%|█████     | 50/100 [00:23<00:22,  2.27it/s, TrL=0.28, TrR=0.4055, TrR²=-0.381, Best=0.3999, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  51%|█████     | 51/100 [00:23<00:21,  2.26it/s, TrL=0.28, TrR=0.4055, TrR²=-0.381, Best=0.3999, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  51%|█████     | 51/100 [00:23<00:21,  2.26it/s, TrL=0.27, TrR=0.3901, TrR²=-0.278, Best=0.3901, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  52%|█████▏    | 52/100 [00:23<00:21,  2.25it/s, TrL=0.27, TrR=0.3901, TrR²=-0.278, Best=0.3901, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  52%|█████▏    | 52/100 [00:24<00:21,  2.25it/s, TrL=0.26, TrR=0.3906, TrR²=-0.281, Best=0.3901, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  53%|█████▎    | 53/100 [00:24<00:20,  2.27it/s, TrL=0.26, TrR=0.3906, TrR²=-0.281, Best=0.3901, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  53%|█████▎    | 53/100 [00:24<00:20,  2.27it/s, TrL=0.25, TrR=0.3867, TrR²=-0.256, Best=0.3867, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  54%|█████▍    | 54/100 [00:24<00:20,  2.28it/s, TrL=0.25, TrR=0.3867, TrR²=-0.256, Best=0.3867, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  54%|█████▍    | 54/100 [00:25<00:20,  2.28it/s, TrL=0.24, TrR=0.3792, TrR²=-0.208, Best=0.3792, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  55%|█████▌    | 55/100 [00:25<00:19,  2.27it/s, TrL=0.24, TrR=0.3792, TrR²=-0.208, Best=0.3792, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  55%|█████▌    | 55/100 [00:25<00:19,  2.27it/s, TrL=0.24, TrR=0.3757, TrR²=-0.186, Best=0.3757, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  56%|█████▌    | 56/100 [00:25<00:19,  2.28it/s, TrL=0.24, TrR=0.3757, TrR²=-0.186, Best=0.3757, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  56%|█████▌    | 56/100 [00:25<00:19,  2.28it/s, TrL=0.23, TrR=0.3717, TrR²=-0.161, Best=0.3717, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  57%|█████▋    | 57/100 [00:25<00:18,  2.31it/s, TrL=0.23, TrR=0.3717, TrR²=-0.161, Best=0.3717, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  57%|█████▋    | 57/100 [00:26<00:18,  2.31it/s, TrL=0.22, TrR=0.3677, TrR²=-0.136, Best=0.3677, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  58%|█████▊    | 58/100 [00:26<00:18,  2.30it/s, TrL=0.22, TrR=0.3677, TrR²=-0.136, Best=0.3677, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  58%|█████▊    | 58/100 [00:26<00:18,  2.30it/s, TrL=0.22, TrR=0.3647, TrR²=-0.117, Best=0.3647, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  59%|█████▉    | 59/100 [00:26<00:17,  2.31it/s, TrL=0.22, TrR=0.3647, TrR²=-0.117, Best=0.3647, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  59%|█████▉    | 59/100 [00:27<00:17,  2.31it/s, TrL=0.21, TrR=0.3615, TrR²=-0.098, Best=0.3615, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  60%|██████    | 60/100 [00:27<00:17,  2.27it/s, TrL=0.21, TrR=0.3615, TrR²=-0.098, Best=0.3615, HoL=0.3, HoR=0.8368, HoR²=-1.809]Training:  60%|██████    | 60/100 [00:27<00:17,  2.27it/s, TrL=0.20, TrR=0.3585, TrR²=-0.080, Best=0.3615, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  61%|██████    | 61/100 [00:27<00:17,  2.24it/s, TrL=0.20, TrR=0.3585, TrR²=-0.080, Best=0.3615, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  61%|██████    | 61/100 [00:28<00:17,  2.24it/s, TrL=0.20, TrR=0.3556, TrR²=-0.062, Best=0.3556, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  62%|██████▏   | 62/100 [00:28<00:16,  2.24it/s, TrL=0.20, TrR=0.3556, TrR²=-0.062, Best=0.3556, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  62%|██████▏   | 62/100 [00:28<00:16,  2.24it/s, TrL=0.19, TrR=0.3528, TrR²=-0.045, Best=0.3528, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  63%|██████▎   | 63/100 [00:28<00:16,  2.24it/s, TrL=0.19, TrR=0.3528, TrR²=-0.045, Best=0.3528, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  63%|██████▎   | 63/100 [00:28<00:16,  2.24it/s, TrL=0.19, TrR=0.3513, TrR²=-0.037, Best=0.3513, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  64%|██████▍   | 64/100 [00:28<00:15,  2.26it/s, TrL=0.19, TrR=0.3513, TrR²=-0.037, Best=0.3513, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  64%|██████▍   | 64/100 [00:29<00:15,  2.26it/s, TrL=0.18, TrR=0.3486, TrR²=-0.021, Best=0.3486, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  65%|██████▌   | 65/100 [00:29<00:15,  2.25it/s, TrL=0.18, TrR=0.3486, TrR²=-0.021, Best=0.3486, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  65%|██████▌   | 65/100 [00:29<00:15,  2.25it/s, TrL=0.18, TrR=0.3465, TrR²=-0.009, Best=0.3465, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  66%|██████▌   | 66/100 [00:29<00:15,  2.26it/s, TrL=0.18, TrR=0.3465, TrR²=-0.009, Best=0.3465, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  66%|██████▌   | 66/100 [00:30<00:15,  2.26it/s, TrL=0.17, TrR=0.3448, TrR²=0.001, Best=0.3448, HoL=0.2, HoR=0.7489, HoR²=-1.250] Training:  67%|██████▋   | 67/100 [00:30<00:14,  2.25it/s, TrL=0.17, TrR=0.3448, TrR²=0.001, Best=0.3448, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  67%|██████▋   | 67/100 [00:30<00:14,  2.25it/s, TrL=0.17, TrR=0.3432, TrR²=0.011, Best=0.3432, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  68%|██████▊   | 68/100 [00:30<00:14,  2.25it/s, TrL=0.17, TrR=0.3432, TrR²=0.011, Best=0.3432, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  68%|██████▊   | 68/100 [00:31<00:14,  2.25it/s, TrL=0.16, TrR=0.3413, TrR²=0.022, Best=0.3413, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  69%|██████▉   | 69/100 [00:31<00:13,  2.27it/s, TrL=0.16, TrR=0.3413, TrR²=0.022, Best=0.3413, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  69%|██████▉   | 69/100 [00:31<00:13,  2.27it/s, TrL=0.16, TrR=0.3393, TrR²=0.033, Best=0.3393, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  70%|███████   | 70/100 [00:31<00:13,  2.26it/s, TrL=0.16, TrR=0.3393, TrR²=0.033, Best=0.3393, HoL=0.2, HoR=0.7489, HoR²=-1.250]Training:  70%|███████   | 70/100 [00:32<00:13,  2.26it/s, TrL=0.16, TrR=0.3378, TrR²=0.042, Best=0.3393, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  71%|███████   | 71/100 [00:32<00:13,  2.22it/s, TrL=0.16, TrR=0.3378, TrR²=0.042, Best=0.3393, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  71%|███████   | 71/100 [00:32<00:13,  2.22it/s, TrL=0.15, TrR=0.3365, TrR²=0.049, Best=0.3365, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  72%|███████▏  | 72/100 [00:32<00:12,  2.24it/s, TrL=0.15, TrR=0.3365, TrR²=0.049, Best=0.3365, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  72%|███████▏  | 72/100 [00:32<00:12,  2.24it/s, TrL=0.15, TrR=0.3347, TrR²=0.059, Best=0.3347, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  73%|███████▎  | 73/100 [00:32<00:12,  2.23it/s, TrL=0.15, TrR=0.3347, TrR²=0.059, Best=0.3347, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  73%|███████▎  | 73/100 [00:33<00:12,  2.23it/s, TrL=0.15, TrR=0.3331, TrR²=0.068, Best=0.3331, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  74%|███████▍  | 74/100 [00:33<00:11,  2.22it/s, TrL=0.15, TrR=0.3331, TrR²=0.068, Best=0.3331, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  74%|███████▍  | 74/100 [00:33<00:11,  2.22it/s, TrL=0.15, TrR=0.3320, TrR²=0.074, Best=0.3320, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  75%|███████▌  | 75/100 [00:33<00:11,  2.22it/s, TrL=0.15, TrR=0.3320, TrR²=0.074, Best=0.3320, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  75%|███████▌  | 75/100 [00:34<00:11,  2.22it/s, TrL=0.14, TrR=0.3305, TrR²=0.083, Best=0.3305, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  76%|███████▌  | 76/100 [00:34<00:11,  2.11it/s, TrL=0.14, TrR=0.3305, TrR²=0.083, Best=0.3305, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  76%|███████▌  | 76/100 [00:34<00:11,  2.11it/s, TrL=0.14, TrR=0.3290, TrR²=0.091, Best=0.3290, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  77%|███████▋  | 77/100 [00:34<00:10,  2.12it/s, TrL=0.14, TrR=0.3290, TrR²=0.091, Best=0.3290, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  77%|███████▋  | 77/100 [00:35<00:10,  2.12it/s, TrL=0.14, TrR=0.3279, TrR²=0.097, Best=0.3279, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  78%|███████▊  | 78/100 [00:35<00:10,  2.13it/s, TrL=0.14, TrR=0.3279, TrR²=0.097, Best=0.3279, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  78%|███████▊  | 78/100 [00:35<00:10,  2.13it/s, TrL=0.14, TrR=0.3268, TrR²=0.103, Best=0.3268, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  79%|███████▉  | 79/100 [00:35<00:09,  2.14it/s, TrL=0.14, TrR=0.3268, TrR²=0.103, Best=0.3268, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  79%|███████▉  | 79/100 [00:36<00:09,  2.14it/s, TrL=0.13, TrR=0.3255, TrR²=0.110, Best=0.3255, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  80%|████████  | 80/100 [00:36<00:09,  2.16it/s, TrL=0.13, TrR=0.3255, TrR²=0.110, Best=0.3255, HoL=0.2, HoR=0.6875, HoR²=-0.896]Training:  80%|████████  | 80/100 [00:36<00:09,  2.16it/s, TrL=0.13, TrR=0.3243, TrR²=0.116, Best=0.3255, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  81%|████████  | 81/100 [00:36<00:09,  2.08it/s, TrL=0.13, TrR=0.3243, TrR²=0.116, Best=0.3255, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  81%|████████  | 81/100 [00:37<00:09,  2.08it/s, TrL=0.13, TrR=0.3231, TrR²=0.123, Best=0.3231, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  82%|████████▏ | 82/100 [00:37<00:08,  2.12it/s, TrL=0.13, TrR=0.3231, TrR²=0.123, Best=0.3231, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  82%|████████▏ | 82/100 [00:37<00:08,  2.12it/s, TrL=0.13, TrR=0.3218, TrR²=0.130, Best=0.3218, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  83%|████████▎ | 83/100 [00:37<00:07,  2.15it/s, TrL=0.13, TrR=0.3218, TrR²=0.130, Best=0.3218, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  83%|████████▎ | 83/100 [00:38<00:07,  2.15it/s, TrL=0.13, TrR=0.3210, TrR²=0.134, Best=0.3210, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  84%|████████▍ | 84/100 [00:38<00:07,  2.18it/s, TrL=0.13, TrR=0.3210, TrR²=0.134, Best=0.3210, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  84%|████████▍ | 84/100 [00:38<00:07,  2.18it/s, TrL=0.13, TrR=0.3198, TrR²=0.141, Best=0.3198, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  85%|████████▌ | 85/100 [00:38<00:06,  2.18it/s, TrL=0.13, TrR=0.3198, TrR²=0.141, Best=0.3198, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  85%|████████▌ | 85/100 [00:39<00:06,  2.18it/s, TrL=0.13, TrR=0.3187, TrR²=0.147, Best=0.3187, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  86%|████████▌ | 86/100 [00:39<00:06,  2.20it/s, TrL=0.13, TrR=0.3187, TrR²=0.147, Best=0.3187, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  86%|████████▌ | 86/100 [00:39<00:06,  2.20it/s, TrL=0.12, TrR=0.3178, TrR²=0.151, Best=0.3178, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  87%|████████▋ | 87/100 [00:39<00:05,  2.19it/s, TrL=0.12, TrR=0.3178, TrR²=0.151, Best=0.3178, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  87%|████████▋ | 87/100 [00:39<00:05,  2.19it/s, TrL=0.12, TrR=0.3168, TrR²=0.157, Best=0.3168, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  88%|████████▊ | 88/100 [00:39<00:05,  2.15it/s, TrL=0.12, TrR=0.3168, TrR²=0.157, Best=0.3168, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  88%|████████▊ | 88/100 [00:40<00:05,  2.15it/s, TrL=0.12, TrR=0.3158, TrR²=0.162, Best=0.3158, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  89%|████████▉ | 89/100 [00:40<00:05,  2.02it/s, TrL=0.12, TrR=0.3158, TrR²=0.162, Best=0.3158, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  89%|████████▉ | 89/100 [00:41<00:05,  2.02it/s, TrL=0.12, TrR=0.3150, TrR²=0.167, Best=0.3150, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  90%|█████████ | 90/100 [00:41<00:05,  1.84it/s, TrL=0.12, TrR=0.3150, TrR²=0.167, Best=0.3150, HoL=0.2, HoR=0.6383, HoR²=-0.634]Training:  90%|█████████ | 90/100 [00:41<00:05,  1.84it/s, TrL=0.12, TrR=0.3140, TrR²=0.172, Best=0.3150, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  91%|█████████ | 91/100 [00:41<00:04,  1.89it/s, TrL=0.12, TrR=0.3140, TrR²=0.172, Best=0.3150, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  91%|█████████ | 91/100 [00:42<00:04,  1.89it/s, TrL=0.12, TrR=0.3132, TrR²=0.176, Best=0.3132, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  92%|█████████▏| 92/100 [00:42<00:04,  1.97it/s, TrL=0.12, TrR=0.3132, TrR²=0.176, Best=0.3132, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  92%|█████████▏| 92/100 [00:42<00:04,  1.97it/s, TrL=0.12, TrR=0.3123, TrR²=0.181, Best=0.3123, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  93%|█████████▎| 93/100 [00:42<00:03,  2.02it/s, TrL=0.12, TrR=0.3123, TrR²=0.181, Best=0.3123, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  93%|█████████▎| 93/100 [00:43<00:03,  2.02it/s, TrL=0.12, TrR=0.3113, TrR²=0.186, Best=0.3113, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  94%|█████████▍| 94/100 [00:43<00:02,  2.03it/s, TrL=0.12, TrR=0.3113, TrR²=0.186, Best=0.3113, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  94%|█████████▍| 94/100 [00:43<00:02,  2.03it/s, TrL=0.11, TrR=0.3106, TrR²=0.190, Best=0.3106, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  95%|█████████▌| 95/100 [00:43<00:02,  2.07it/s, TrL=0.11, TrR=0.3106, TrR²=0.190, Best=0.3106, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  95%|█████████▌| 95/100 [00:44<00:02,  2.07it/s, TrL=0.11, TrR=0.3098, TrR²=0.194, Best=0.3098, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  96%|█████████▌| 96/100 [00:44<00:01,  2.11it/s, TrL=0.11, TrR=0.3098, TrR²=0.194, Best=0.3098, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  96%|█████████▌| 96/100 [00:44<00:01,  2.11it/s, TrL=0.11, TrR=0.3089, TrR²=0.198, Best=0.3089, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  97%|█████████▋| 97/100 [00:44<00:01,  2.11it/s, TrL=0.11, TrR=0.3089, TrR²=0.198, Best=0.3089, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  97%|█████████▋| 97/100 [00:44<00:01,  2.11it/s, TrL=0.11, TrR=0.3082, TrR²=0.202, Best=0.3082, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  98%|█████████▊| 98/100 [00:44<00:00,  2.16it/s, TrL=0.11, TrR=0.3082, TrR²=0.202, Best=0.3082, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  98%|█████████▊| 98/100 [00:45<00:00,  2.16it/s, TrL=0.11, TrR=0.3074, TrR²=0.206, Best=0.3074, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  99%|█████████▉| 99/100 [00:45<00:00,  2.16it/s, TrL=0.11, TrR=0.3074, TrR²=0.206, Best=0.3074, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training:  99%|█████████▉| 99/100 [00:45<00:00,  2.16it/s, TrL=0.11, TrR=0.3066, TrR²=0.210, Best=0.3066, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training: 100%|██████████| 100/100 [00:45<00:00,  2.17it/s, TrL=0.11, TrR=0.3066, TrR²=0.210, Best=0.3066, HoL=0.2, HoR=0.5987, HoR²=-0.438]Training: 100%|██████████| 100/100 [00:45<00:00,  2.18it/s, TrL=0.11, TrR=0.3066, TrR²=0.210, Best=0.3066, HoL=0.2, HoR=0.5987, HoR²=-0.438]
================================================================================

TEST RESULTS:
================================================================================
Training R²: 0.9094
Training RMSE (orig): 455,254
Holdout R²: 0.1524
Holdout RMSE (orig): 1,131,581
R² Gap: 0.7570

================================================================================
TESTING ATTRIBUTION (Simple Additivity Check)
================================================================================

Component shapes (scaled space):
  Predictions: torch.Size([190, 107])
  Baseline: torch.Size([190, 107])
  Media: torch.Size([190, 107, 13])
  Controls: torch.Size([190, 107, 7])
  Seasonal: torch.Size([190, 107])
  Trend: torch.Size([190, 107])
  Prediction scale: 0.4693

Additivity Check (Original Scale):
  Mean prediction: 838,464
  Mean components sum: 1,056,262
  Mean absolute difference: 217798.23
  Max absolute difference: 5943196.12
  Relative error: 25.9759%
  ✗ FAIL: Components don't sum correctly

Attribution (% of total):
  Media: 16.9%
  Baseline: 72.7%
  Controls: -8.3%
  Seasonality: 26.0%
  Trend: 18.7%
  Total: 126.0%
  ? Media attribution is 16.9% (expected ~40%)

================================================================================
TEST COMPLETE!
================================================================================

Next steps:
1. If test passes, run full 2500 epochs
2. Verify attribution stays ~40% with full training
3. Compare with log-space results
================================================================================
